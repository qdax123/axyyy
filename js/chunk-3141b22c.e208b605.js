(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-3141b22c"],{2425:function(t,s,i){"use strict";i.r(s);var a=function(){var t=this,s=t._self._c;return s("div",{staticClass:"detail"},[s("div",{staticClass:"w1200"},[s("div",{staticClass:"detail-container"},[s("div",{staticClass:"detail-main"},[s("div",{staticClass:"cover"},[s("div",{staticClass:"cover-img"},[s("el-image",{attrs:{src:t.details.coverImgUrl}},[s("div",{staticClass:"image-slot",attrs:{slot:"placeholder"},slot:"placeholder"},[s("i",{staticClass:"iconfont icon-placeholder"})])])],1),s("div",{staticClass:"cover-info"},[s("div",{staticClass:"cover-title"},[t._v(" "+t._s(t.details.name)+" ")]),t.details.creator?s("div",{staticClass:"cover-author"},[s("el-image",{staticClass:"cover-avatar",attrs:{src:t.details.creator.avatarUrl}},[s("div",{staticClass:"image-slot",attrs:{slot:"placeholder"},slot:"placeholder"},[s("i",{staticClass:"iconfont icon-placeholder"})])]),s("div",{staticClass:"cover-name"},[t._v(t._s(t.details.creator.nickname))]),s("div",{staticClass:"cover-date"},[t._v(t._s(t.$utils.formartDate(t.details.createTime,"yyyy-MM-dd")))])],1):t._e(),t.details.tags?s("div",{staticClass:"cover-tags"},t._l(t.details.tags,(function(i,a){return s("router-link",{key:a,staticClass:"tag",attrs:{to:{path:"/playlist",query:{cat:i}}}},[t._v("#"+t._s(i))])})),1):t._e(),s("div",{staticClass:"cover-digital"},[s("span",{staticClass:"cover-playCount"},[s("i",{staticClass:"iconfont icon-playnum"}),t._v(" "+t._s(t.$utils.formartNum(t.details.playCount))+"次")]),s("span",{staticClass:"cover-collect"},[s("i",{staticClass:"iconfont icon-collect"}),t._v(" "+t._s(t.$utils.formartNum(t.details.subscribedCount)))]),s("span",{staticClass:"cover-comment"},[s("i",{staticClass:"iconfont icon-comment"}),t._v(" "+t._s(t.$utils.formartNum(t.details.commentCount)))])]),s("div",{staticClass:"cover-desc"},[s("h5",[t._v("歌单简介"),t.isShowDesc?s("em",{staticClass:"desc-close",on:{click:function(s){t.isShowDesc=!1}}},[s("i",{staticClass:"iconfont icon-closed"})]):t._e()]),s("p",{domProps:{innerHTML:t._s(t.details.description)},on:{click:t.showAllDesc}}),t.isShowDesc?s("pre",{staticClass:"cover-desc-all"},[t._v("                                "+t._s(t.details.description)+"\n                            ")]):t._e()])])]),s("div",{staticClass:"song-main"},[s("div",{staticClass:"song-header"},[s("h4",[t._v("歌曲列表 "),s("em",[t._v(t._s(t.total+"首歌"))])]),s("span",{staticClass:"play-all",on:{click:t.playAllSongs}},[s("i",{staticClass:"iconfont icon-audio-play"}),t._v(" 播放全部")]),s("span",{class:["collect",t.details.subscribed?"active":""],on:{click:function(s){return t.subPlayList(t.details)}}},[s("i",{class:["iconfont","icon-collect"+(t.details.subscribed?"-active":"")]}),t._v(" "+t._s(t.details.subscribed?"已收藏":"收藏"))])]),t.isLoading?[s("Loading")]:[s("song-list",{attrs:{songList:t.songList,stripe:!0}}),t.isLogin?t._e():s("div",{staticClass:"showAllSongsTips"},[s("span",{on:{click:t.loginDialog}},[t._v("登录后查看全部歌曲")])])]],2)]),s("div",{staticClass:"detail-aside"},[s("div",{staticClass:"playlist-collect"},[s("h3",{staticClass:"aside-title"},[t._v("喜欢这个歌单的人")]),s("div",{staticClass:"aside-main collect-main"},t._l(t.collects,(function(t){return s("router-link",{key:t.userId,staticClass:"collect-author",attrs:{to:{path:"/singer",query:{id:t.userId}}}},[s("el-image",{attrs:{src:t.avatarUrl}},[s("div",{staticClass:"image-slot",attrs:{slot:"placeholder"},slot:"placeholder"},[s("i",{staticClass:"iconfont icon-placeholder"})])])],1)})),1)]),s("div",{staticClass:"playlist-recom"},[s("h3",{staticClass:"aside-title"},[t._v("相关歌单推荐")]),s("div",{staticClass:"aside-main recom-main"},t._l(t.playlists,(function(i){return s("router-link",{key:i.id,staticClass:"recom-item",attrs:{to:{path:"/playlist/detail",query:{id:i.id}}}},[s("el-image",{attrs:{src:i.coverImgUrl}},[s("div",{staticClass:"image-slot",attrs:{slot:"placeholder"},slot:"placeholder"},[s("i",{staticClass:"iconfont icon-placeholder"})])]),s("div",{staticClass:"recom-info"},[s("div",{staticClass:"recom-name"},[t._v(t._s(i.name))]),s("div",{staticClass:"recom-author"},[t._v(" By. "),s("router-link",{attrs:{to:{path:"/user",query:{id:i.creator.userId}}}},[t._v(t._s(i.creator.nickname))])],1)])],1)})),1)]),s("div",{staticClass:"playlist-comment"},[s("h3",{staticClass:"aside-title"},[t._v("歌单评论")]),s("div",{staticClass:"aside-main comment-main"},t._l(t.comments,(function(i){return s("div",{key:i.commentId,staticClass:"comment-item"},[s("router-link",{attrs:{to:{path:"/user",query:{id:i.commentId}}}},[s("el-image",{attrs:{src:i.user.avatarUrl}},[s("div",{staticClass:"image-slot",attrs:{slot:"placeholder"},slot:"placeholder"},[s("i",{staticClass:"iconfont icon-placeholder"})])])],1),s("div",{staticClass:"comment-info"},[s("div",{staticClass:"comment-userInfo"},[s("router-link",{staticClass:"comment-name",attrs:{to:{path:"/user",query:{id:i.commentId}}}},[t._v(t._s(i.user.nickname))]),s("span",{staticClass:"comment-date"},[t._v(t._s(t.$utils.formatMsgTime(i.time)))])],1),s("div",{staticClass:"comment-desc"},[t._v(t._s(i.content))])])],1)})),0)])])])])])},e=[],l=(i("14d9"),i("2f62")),c=i("eb4d"),o=i("18fd"),n=i("bf93"),r={name:"PlayListDetail",components:{songList:o["a"],Loading:n["a"]},mounted(){this._initialize(this.$route.query.id)},data(){return{details:{},songList:[],collects:[],playlists:[],comments:[],total:0,isLoading:!0,isShowDesc:!1}},computed:{...Object(l["c"])(["isLogin","playList"])},methods:{...Object(l["d"])({setPlayStatus:"SET_PLAYSTATUS",setPlayList:"SET_PLAYLIST",setPlayIndex:"SET_PLAYINDEX"}),...Object(l["b"])(["loginSuc","playAll"]),_initialize(t){this.getDetail({id:t,s:8}),this.getCollect({id:t,limit:18}),this.getRecom({id:t}),this.getComment({id:t,limit:9})},async getDetail(t){this.isLoading=!0;const{data:s}=await this.$http.playlistdetail(t);if(200!==s.code)return this.$msg.error("数据请求失败");if(this.details=s.playlist,this.isLogin){const t=s.playlist.trackIds;this.getAllSongs(t)}else this.songList=this._formatSongs(s.playlist.tracks),this.total=this.songList.length,this.isLoading=!1},async getCollect(t){const{data:s}=await this.$http.playlistSCollect(t);if(200!==s.code)return this.$msg.error("数据请求失败");this.collects=s.subscribers},async getRecom(t){const{data:s}=await this.$http.playlistRelated(t);if(200!==s.code)return this.$msg.error("数据请求失败");this.playlists=s.playlists},async getComment(t){const{data:s}=await this.$http.playlistComment(t);if(200!==s.code)return this.$msg.error("数据请求失败");this.comments=s.comments},showAllDesc(){this.details.description.length>120&&(this.isShowDesc=!this.isShowDesc)},async getAllSongs(t){const s=[],i=500;let a=[];for(let e=0;e<t.length;e+=i)s.push(t.slice(e,e+i));for(let e=0;e<s.length;e++){const t=[];s[e].map(s=>{t.push(s.id)}),this.isLoading=!0;const{data:i}=await this.$http.songDetail({ids:t.join(","),timestamp:(new Date).valueOf()+e});a=a.concat(this._formatSongs(i))}this.songList=a,this.total=a.length,this.isLoading=!1},loginDialog(){this.$store.dispatch("loginSuc",!0)},_formatSongs(t){const s=[];return t.songs.map((i,a)=>{i.id&&(i.license=!t.privileges[a].cp,s.push(Object(c["a"])(i)))}),s},playAllSongs(){this.playAll({list:this.songList})},async subPlayList(t){const{data:s}=await this.$http.subPlayList({id:t.id,t:t.subscribed?2:1});if(200!==s.code)return this.$msg.error("数据请求失败");this.details.subscribed=!this.details.subscribed}},watch:{$route(t,s){const i=this.$route.query.id;i&&(this.songList=[],this.total=0,this._initialize(i))},isLogin(t,s){if(t){const t=this.details.trackIds;this.getAllSongs(t)}else this.songList=this.details.tracks,this.total=this.details.tracks.length}}},d=r,m=(i("55b3"),i("2877")),h=Object(m["a"])(d,a,e,!1,null,"3b76e341",null);s["default"]=h.exports},"55b3":function(t,s,i){"use strict";i("9fd0")},"9fd0":function(t,s,i){}}]);
//# sourceMappingURL=chunk-3141b22c.e208b605.js.map